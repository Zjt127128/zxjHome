webpackJsonp([1],{ooim:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("mvHQ"),a=r.n(n),o=r("woOf"),i=r.n(o),l=r("FWz8"),s=r("Llv5"),c=r("xT6B"),u={pageNum:1,pageSize:10,id:null,orderType:null,createTime:null,storeId:-1},d={name:"orderList",data:function(){return{rejectRow:null,rejectReason:null,rejectConfirmDialogVisible:!1,options:[],value:"",listQuery:i()({},u),listLoading:!0,list:null,total:null,operateType:null,multipleSelection:[],closeOrder:{dialogVisible:!1,content:null,orderIds:[]},orderTypeOptions:[{label:"待点餐",value:0},{label:"待支付",value:1},{label:"确认中",value:2},{label:"备餐中",value:3},{label:"待用餐",value:4},{label:"待取餐",value:5},{label:"配送中",value:6},{label:"已完成",value:7},{label:"取消中",value:8},{label:"已取消",value:9}],operateOptions:[{label:"删除订单",value:0}],logisticsDialogVisible:!1}},created:function(e){var t=this;console.log("进入 order-index，路由是: ",this.$route.path);for(var r=["/order-ms/order","/order-ms/toBePaidOrderList","/order-ms/toBeConfirmedOrderList","/order-ms/inDistributionOrderList","/order-ms/mealWaitingOrderList","/order-ms/ealPreparationOrderList","/order-ms/toBeDinedOrderList","/order-ms/cancelOrderList"],n=[null,1,2,6,5,3,4,8],a=0;a<r.length;a++)if(r[a]==this.$route.path){this.listQuery.orderType=n[a];break}this.getList(),Object(s.b)({pageNum:1,pageSize:-1}).then(function(e){t.options=e.data.arrays,t.options.push({name:"全部门店",id:-1})})},filters:{formatStoreName:function(e,t){console.log("id==",e,"stors ==",t);for(var r=0;r<t.length;r++)if(t[r].id==e)return t[r].name},formatCreateTime:function(e){var t=new Date(e);return Object(c.a)(t,"yyyy-MM-dd hh:mm:ss")},formatOrderType:function(e){return["待支付保证金","待支付","确认中","备餐中","待用餐","待取餐","配送中","已完成","取消确认中","已取消"][e]},formatConsumeType:function(e){return["扫码点餐","到店消费","到店自取","外卖配送"][e]}},methods:{handleRejectConfirm:function(){var e=this;this.$confirm("是否要进行该操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.rejectRow;console.log("order == ",t),Object(l.e)(t.id,t.userId,t.storeId,e.rejectReason).then(function(t){e.rejectRow=null,e.rejectReason=null,e.rejectConfirmDialogVisible=!1,e.getList(),e.$message({message:"操作成功！",type:"success",duration:1e3})})})},shopChange:function(e){console.log(e)},handleResetSearch:function(){this.listQuery=i()({},u)},handleSearchList:function(){this.listQuery.pageNum=1,this.getList()},handleSelectionChange:function(e){this.multipleSelection=e},handleViewOrder:function(e,t){this.$router.push({path:"/order-ms/orderDetail",query:{id:t.id}})},handleOrderTypeEvent1:function(e,t){this.$router.push({path:"/order-ms/handleToBePaidOrder",query:{id:t.id}})},handleOrderTypeChange:function(e,t){var r=this;console.log("rororo = ",t),this.$confirm("是否要进行该操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.g)(t.id,t.consumeType,t.orderType).then(function(e){r.$message({message:"操作成功！",type:"success",duration:1e3}),r.getList()})})},handleOrderTypeEvent2B:function(e,t){this.rejectRow=t,this.rejectReason=null,this.rejectConfirmDialogVisible=!0},handleOrderTypeEvent8:function(e,t){this.$router.push({path:"/order-ms/handleCancelOrder",query:{id:t.id}})},handleDeleteOrder:function(e,t){var r=[];r.push(t.id),this.deleteOrder(r)},handleBatchOperate:function(){if(null==this.multipleSelection||this.multipleSelection.length<1)this.$message({message:"请选择要操作的订单",type:"warning",duration:1e3});else if(0===this.operateType){for(var e=[],t=0;t<this.multipleSelection.length;t++)e.push(this.multipleSelection[t].id);console.log("ooo",e),this.deleteOrder(e)}},handleSizeChange:function(e){this.listQuery.pageNum=1,this.listQuery.pageSize=e,this.getList()},handleCurrentChange:function(e){this.listQuery.pageNum=e,this.getList()},getList:function(){var e=this;this.listLoading=!0,Object(l.b)(this.listQuery).then(function(t){console.log("total = ",t.data.total),e.listLoading=!1,e.list=t.data.arrays,e.total=t.data.total})},deleteOrder:function(e){var t=this;this.$confirm("是否要进行该删除操作? 删除订单不会影响首页的总览数据与客户端中数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var r=new URLSearchParams;r.append("ids",e),console.log(r,a()(r),e,a()(e)),Object(l.a)(r).then(function(e){t.$message({message:"删除成功！",type:"success",duration:1e3}),t.getList()})})}}},p={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"select_shop"},[[r("el-select",{attrs:{placeholder:"全部门店"},on:{change:e.shopChange},model:{value:e.listQuery.storeId,callback:function(t){e.$set(e.listQuery,"storeId",t)},expression:"listQuery.storeId"}},e._l(e.options,function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}},[e._v("\n            "+e._s(t.name)+"\n          ")])}))]],2),e._v(" "),r("el-card",{staticClass:"filter-container",attrs:{shadow:"never"}},[r("div",[r("i",{staticClass:"el-icon-search"}),e._v(" "),r("span",[e._v("筛选搜索")]),e._v(" "),r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.handleSearchList()}}},[e._v("\n          搜索\n        ")]),e._v(" "),r("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:function(t){e.handleResetSearch()}}},[e._v("\n          重置\n        ")])],1),e._v(" "),r("div",{staticStyle:{"margin-top":"15px"}},[r("el-form",{attrs:{inline:!0,model:e.listQuery,size:"small","label-width":"140px"}},[r("el-form-item",{attrs:{label:"输入搜索："}},[r("el-input",{staticClass:"input-width",attrs:{placeholder:"订单编号"},model:{value:e.listQuery.keyword,callback:function(t){e.$set(e.listQuery,"keyword",t)},expression:"listQuery.keyword"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"提交时间："}},[r("el-date-picker",{staticClass:"input-width",attrs:{"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd",type:"date",placeholder:"请选择时间"},model:{value:e.listQuery.createTime,callback:function(t){e.$set(e.listQuery,"createTime",t)},expression:"listQuery.createTime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"订单状态："}},[r("el-select",{staticClass:"input-width",attrs:{placeholder:"全部",clearable:""},model:{value:e.listQuery.orderType,callback:function(t){e.$set(e.listQuery,"orderType",t)},expression:"listQuery.orderType"}},e._l(e.orderTypeOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1)]),e._v(" "),r("el-card",{staticClass:"operate-container",attrs:{shadow:"never"}},[r("i",{staticClass:"el-icon-tickets"}),e._v(" "),r("span",[e._v("订单列表")])]),e._v(" "),r("div",{staticClass:"table-container"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"orderTable",staticStyle:{width:"100%"},attrs:{data:e.list,border:"","default-sort":{prop:"id",order:"ascending"}},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{label:"订单编号",width:"100",align:"center",prop:"id",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.id))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"提交时间",width:"150",align:"center",prop:"date",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatCreateTime")(t.row.createTime)))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"用户ID",align:"center",sortable:"",prop:"userId"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.userId))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"消费门店 / 桌号",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatStoreName")(t.row.storeId,e.options))+"/\n            "+e._s(t.row.table+"桌")+"\n          ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"消费方式",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatConsumeType")(t.row.consumeType))+"\n          ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"待支付/支付金额(实)",width:"120",align:"center",prop:"qian",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.otherFee+t.row.originalPrice-t.row.shopDiscount-t.row.couponDiscount))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"取餐号",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.fetchMealCode?t.row.fetchMealCode:"无"))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"订单状态",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatOrderType")(t.row.orderType)))]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",[r("el-button",{attrs:{size:"mini"},on:{click:function(r){e.handleViewOrder(t.$index,t.row)}}},[e._v("查看详情")])],1),e._v(" "),r("p",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:1===t.row.orderType&&t.row.consumeType<2,expression:"scope.row.orderType === 1&&scope.row.consumeType<2"}],attrs:{size:"mini",type:"primary"},on:{click:function(r){e.handleOrderTypeEvent1(t.$index,t.row)}}},[e._v("处理订单")])],1),e._v(" "),r("p",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:2===t.row.orderType,expression:"scope.row.orderType === 2"}],attrs:{size:"mini",type:"primary"},on:{click:function(r){e.handleOrderTypeChange(t.$index,t.row)}}},[e._v("确认订单")])],1),e._v(" "),r("p",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:2===t.row.orderType,expression:"scope.row.orderType === 2"}],attrs:{size:"mini",type:"danger"},on:{click:function(r){e.handleOrderTypeEvent2B(t.$index,t.row)}}},[e._v("拒绝服务")])],1),e._v(" "),r("p",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:3===t.row.orderType,expression:"scope.row.orderType === 3"}],attrs:{size:"mini",type:"primary"},on:{click:function(r){e.handleOrderTypeChange(t.$index,t.row)}}},[e._v("备餐完成")])],1),e._v(" "),r("p",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:4===t.row.orderType,expression:"scope.row.orderType === 4"}],attrs:{size:"mini",type:"primary"},on:{click:function(r){e.handleOrderTypeChange(t.$index,t.row)}}},[e._v("人已到店")])],1),e._v(" "),r("p",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:5===t.row.orderType,expression:"scope.row.orderType === 5"}],attrs:{size:"mini",type:"primary"},on:{click:function(r){e.handleOrderTypeChange(t.$index,t.row)}}},[e._v("取餐成功")])],1),e._v(" "),r("p",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:6===t.row.orderType,expression:"scope.row.orderType === 6"}],attrs:{size:"mini",type:"primary"},on:{click:function(r){e.handleOrderTypeChange(t.$index,t.row)}}},[e._v("配送完毕")])],1),e._v(" "),r("p",[r("el-button",{directives:[{name:"show",rawName:"v-show",value:8===t.row.orderType,expression:"scope.row.orderType === 8"}],attrs:{size:"mini",type:"primary"},on:{click:function(r){e.handleOrderTypeEvent8(t.$index,t.row)}}},[e._v("处理订单")])],1),e._v(" "),r("p",[r("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(r){e.handleDeleteOrder(t.$index,t.row)}}},[e._v("删除记录")])],1)]}}])})],1)],1),e._v(" "),r("div",{staticClass:"batch-operate-container"},[r("el-select",{attrs:{size:"small",placeholder:"批量操作"},model:{value:e.operateType,callback:function(t){e.operateType=t},expression:"operateType"}},e._l(e.operateOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),r("el-button",{staticClass:"search-button",staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.handleBatchOperate()}}},[e._v("\n        确定\n      ")])],1),e._v(" "),r("div",{staticClass:"pagination-container"},[r("el-pagination",{attrs:{background:"",layout:"total, sizes,prev, pager, next,jumper","current-page":e.listQuery.pageNum,"page-size":e.listQuery.pageSize,"page-sizes":[5,10,20,40,80],total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.listQuery,"pageNum",t)}}})],1),e._v(" "),r("el-dialog",{attrs:{title:"拒绝订单",visible:e.rejectConfirmDialogVisible,width:"40%"},on:{"update:visible":function(t){e.rejectConfirmDialogVisible=t}}},[r("el-form",{attrs:{model:e.rejectReason,"label-width":"150px"}},[r("el-form-item",{attrs:{label:"拒绝理由：","label-width":"100px"}},[r("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:e.rejectReason,callback:function(t){e.rejectReason=t},expression:"rejectReason"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.rejectConfirmDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleRejectConfirm}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var h=r("VU/8")(d,p,!1,function(e){r("qB5j")},"data-v-3290e9ca",null);t.default=h.exports},qB5j:function(e,t){}});
//# sourceMappingURL=1.6562cd22dff040a8c6cd.js.map