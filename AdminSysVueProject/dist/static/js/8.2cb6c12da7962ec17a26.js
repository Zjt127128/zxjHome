webpackJsonp([8],{"3VyH":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"addProduct",components:{DishDetail:o("VkZB").a}},l={render:function(){var e=this.$createElement;return(this._self._c||e)("dish-detail",{attrs:{"is-edit":!1}})},staticRenderFns:[]};var r=o("VU/8")(a,l,!1,function(e){o("wdwh")},null,null);t.default=r.exports},PkjI:function(e,t){},VkZB:function(e,t,o){"use strict";var a=o("mvHQ"),l=o.n(a),r=o("woOf"),i=o.n(r),n=o("/1c3"),s={name:null,dishImg:null,price:null,desc:null,mainIngredient:null,ingredient:null,makeMethod:null,weight:null,makeTime:null,marketingType:[],discount:{type:0,val:0,count:0},classificationIds:[],tags:null},c={name:"DishDetail",props:{isEdit:{type:Boolean,default:!1}},data:function(){return{url:"https://happysnaker.xyz:8089/upload_img",loading:!1,cs:[],rules:{name:[{required:!0,message:"请输入菜品名称",trigger:"blur"},{min:1,max:20,message:"长度为 1 到 20 个字符",trigger:"blur"}],dishImg:[{required:!0,message:"请输入菜品图片URL",trigger:"blur"}],price:[{required:!0,message:"请输入菜品单价",trigger:"blur"},{type:"number",message:"必须为整数或者小数",trigger:"blur"}],weight:[{type:"number",message:"必须为整数或者小数",trigger:"blur"}],desc:[{required:!0,message:"请输入内容",trigger:"blur"}]},form:i()({},s)}},created:function(){var e=this;this.getClassificationList(),this.isEdit&&this.getDishFromServer(this.$route.query.id).then(function(t){e.productParam=t.data})},methods:{removeImg:function(){this.form.img=null},test:function(){console.log("test",this.form.classificationIds,this.form.marketingType)},getDishFromServer:function(e){var t=this;Object(n.d)(e).then(function(e){console.log(e.data);var o="",a=[];e.data.tags.forEach(function(e){return o+=e.replace(",","")+" "}),1==e.data.recommendStatus&&a.push("菜品推荐"),1==e.data.newStatus&&a.push("新品推荐"),null==e.data.discount&&(e.data.discount={type:0,val:0,count:0}),e.data.marketingType=a,t.form=e.data,t.form.tags=o,console.log("form == ",t.form),console.log("获取成功")}).catch(function(e){console.log("获取失败")})},handleImgChange:function(){},finishCommit:function(){var e=this;console.log(this.form),this.$refs.form.validate(function(t){if(console.log(t),!t)return console.log("error submit!!"),alert("您填写的表单有误，请重新填写"),!1;var o=e.isEdit;e.$confirm("是否要提交该产品","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.form;console.log(t.tags),t.tags=t.tags.split("/s+/"),o?Object(n.g)(l()(t)).then(function(t){e.$message({type:"success",message:"提交成功",duration:1e3}),e.$router.back()}).catch(function(e){t.tags=""}):Object(n.a)(l()(t)).then(function(t){e.$message({type:"success",message:"提交成功",duration:1e3}),location.reload()}).catch(function(e){t.tags=""})})})},beforeImgUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type,o=e.size<10485760;return t||this.$message.error("上传图片只能是 JPG 或 PNG 格式"),o||this.$message.error("上传图片大小不能超过 10MB"),this.form.img="",t&&o},getClassificationList:function(){var e=this;Object(n.b)().then(function(t){var o=t.data.arrays.filter(function(e){return e.id<1e5});e.cs=o,console.log("cs == ",l()(e.cs))}).catch(function(e){console.log("获取Cshivering"+e)})},handleImgUploadSuccess:function(e){console.log("secuss",e),this.form.img=e},handleImgUploadFail:function(e){console.log("fail")}}},m={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-card",{staticClass:"form-container",attrs:{shadow:"never"}},[o("span",{staticClass:"title"},[e._v("填写菜品表单: ")]),e._v(" "),o("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{"label-width":"100px",label:"菜品名称:",prop:"name"}},[o("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),o("el-form-item",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"label-width":"100px",label:"菜品图片:",prop:"img"}},[o("el-input",{attrs:{placeholder:"请填写图片URL，如您需要上传本地图片，请点击下方按钮上传"},model:{value:e.form.dishImg,callback:function(t){e.$set(e.form,"dishImg",t)},expression:"form.dishImg"}}),e._v(" "),o("el-upload",{staticClass:"upload-demo",attrs:{action:e.url,"on-change":e.handleChange,"file-list":e.fileList,"on-success":e.handleImgUploadSuccess,"on-error":e.handleImgUploadFail,"before-upload":e.beforeImgUpload,"on-remove":e.removeImg,limit:1,headers:e.token,"list-type":"picture"}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传本地图片")])],1)],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"菜品单价:",prop:"price"}},[o("el-input",{attrs:{placeholder:"请填写一个小数或整数，单位是元"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",e._n(t))},expression:"form.price"}})],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"菜品描述:",prop:"desc"}},[o("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请简要描述该菜品"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"菜品主料:",prop:"mainIngredient"}},[o("el-input",{model:{value:e.form.mainIngredient,callback:function(t){e.$set(e.form,"mainIngredient",t)},expression:"form.mainIngredient"}})],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"菜品辅料:",prop:"ingredient"}},[o("el-input",{model:{value:e.form.ingredient,callback:function(t){e.$set(e.form,"ingredient",t)},expression:"form.ingredient"}})],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"菜品分类:",prop:"kind"}},[o("el-checkbox-group",{model:{value:e.form.classificationIds,callback:function(t){e.$set(e.form,"classificationIds",t)},expression:"form.classificationIds"}},e._l(e.cs,function(t){return o("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])}))],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"制作方法:",prop:"makeMethod"}},[o("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请简要描述菜品制作方法"},model:{value:e.form.makeMethod,callback:function(t){e.$set(e.form,"makeMethod",t)},expression:"form.makeMethod"}})],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"菜品重量:",prop:"weight"}},[o("el-input",{attrs:{placeholder:"请输入一个整数或小数，单为是克(g)"},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight",e._n(t))},expression:"form.weight"}})],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"制作时间:",prop:"makeTime"}},[o("el-input",{model:{value:e.form.makeTime,callback:function(t){e.$set(e.form,"makeTime",t)},expression:"form.makeTime"}})],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"是否推荐: "}},[o("el-checkbox-group",{on:{change:e.test},model:{value:e.form.marketingType,callback:function(t){e.$set(e.form,"marketingType",t)},expression:"form.marketingType"}},[o("el-checkbox",{attrs:{label:"新品推荐"}}),e._v(" "),o("el-checkbox",{attrs:{label:"菜品推荐"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"推荐理由:",prop:"makeMethod"}},[o("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请简要描述推荐理由(选填，当您选择菜品推荐时可选择填写此项，如果您不填写此项，则默认选择菜品描述作为原因)"},model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}})],1),e._v(" "),o("el-form-item",{attrs:{"label-width":"100px",label:"菜品标签:",prop:"tags"}},[o("el-input",{attrs:{type:"textarea",rows:3,placeholder:"多个标签请以空格或换行分隔，如：养生菜 下酒菜 适合小孩子吃"},model:{value:e.form.tags,callback:function(t){e.$set(e.form,"tags",t)},expression:"form.tags"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"优惠方式: ","label-width":"100px"}},[o("el-radio-group",{attrs:{size:"medium"},model:{value:e.form.discount.type,callback:function(t){e.$set(e.form.discount,"type",t)},expression:"form.discount.type"}},[o("el-radio-button",{attrs:{border:"",label:"0"}},[e._v("无优惠")]),e._v(" "),o("el-radio-button",{attrs:{border:"",label:"1"}},[e._v("折扣优惠")]),e._v(" "),o("el-radio-button",{attrs:{border:"",label:"2"}},[e._v("立减优惠")])],1)],1),e._v(" "),0!==e.form.discount.type?o("el-form-item",{attrs:{label:"优惠力度: ","label-width":"100px",prop:"discountVal"}},[1==e.form.discount.type?o("el-input",{attrs:{placeholder:"请输入折扣力度，输入应为一个 0 ~ 10 之间的数，例如输入 9 表示九折"},model:{value:e.form.discount.val,callback:function(t){e.$set(e.form.discount,"val",e._n(t))},expression:"form.discount.val"}}):e._e(),e._v(" "),2==e.form.discount.type?o("el-input",{attrs:{placeholder:"请输入立减价格，输入应为一个整数或小数，单位为元"},model:{value:e.form.discount.val,callback:function(t){e.$set(e.form.discount,"val",t)},expression:"form.discount.val"}}):e._e()],1):e._e(),e._v(" "),0!==e.form.discount.type?o("el-form-item",{attrs:{label:"次数限制: ","label-width":"100px",prop:"discountVal"}},[0!=e.form.discount.type?o("el-input",{attrs:{placeholder:"请输入用户对于该菜品每日最多可享受优惠的次数(次数每日凌晨两点刷新)，如果为 -1 表示不限制"},model:{value:e.form.discount.count,callback:function(t){e.$set(e.form.discount,"count",e._n(t))},expression:"form.discount.count"}}):e._e()],1):e._e(),e._v(" "),o("el-form-item",{staticStyle:{"margin-left":"20px"}},[o("el-button",{attrs:{type:"primary"},on:{click:e.finishCommit}},[e._v("立即创建")]),e._v(" "),o("el-button",[e._v("取消")])],1)],1)],1)},staticRenderFns:[]};var u=o("VU/8")(c,m,!1,function(e){o("PkjI")},null,null);t.a=u.exports},wdwh:function(e,t){}});
//# sourceMappingURL=8.2cb6c12da7962ec17a26.js.map