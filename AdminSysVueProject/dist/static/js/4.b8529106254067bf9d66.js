webpackJsonp([4],{H4zi:function(e,t,a){"use strict";var l=a("woOf"),o=a.n(l),r=a("Llv5"),n=a("TIfe"),s={name:null,img:null,address:null,contactPhone:null,time:null,supportTakeout:0,tables:[]},i={name:"StoreDetail",props:{isEdit:{type:Boolean,default:!1}},data:function(){return{token:{Authorization:Object(n.a)()},fileList:[],url:"https://happysnaker.xyz:8089/upload_img",tableNum:0,rules:{name:[{required:!0,message:"请输入店铺名称",trigger:"blur"},{min:1,max:20,message:"长度为 1 到 20 个字符",trigger:"blur"}],img:[{required:!0,message:"请输入店铺图片URL",trigger:"blur"}]},form:o()({},s)}},created:function(){var e=this;this.isEdit&&Object(r.c)(this.$route.query.id).then(function(t){e.form=t.data,e.tableNum=e.form.tables.length,e.handleChange(),console.log("form == ",e.form)})},methods:{removeImg:function(){this.form.img=null},handleChange:function(){var e=this.tableNum,t=Math.abs(e-this.form.tables.length);console.log(e,t);for(var a=t-1;a>=0;a--)e>this.form.tables.length?this.form.tables.push({table:e-a,capacity:null}):this.form.tables.pop()},finishCommit:function(e){var t=this;console.log(e),this.$refs[e].validate(function(e){if(console.log(e),!e)return console.log("error submit!!"),alert("您填写的表单有误，请重新填写"),!1;var a=t.isEdit;t.$confirm("是否要提交该产品","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a?Object(r.e)(t.form).then(function(e){t.$message({type:"success",message:"提交成功",duration:1e3}),t.$router.back()}):Object(r.a)(t.form).then(function(e){t.$message({type:"success",message:"提交成功",duration:1e3}),location.reload()})})})},beforeImgUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type,a=e.size<10485760;return t||this.$message.error("上传图片只能是 JPG 或 PNG 格式"),a||this.$message.error("上传图片大小不能超过 10MB"),this.form.img="",t&&a},handleImgUploadSuccess:function(e){console.log("secuss",e),this.form.img=e},handleImgUploadFail:function(e){console.log("fail")}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"form-container",attrs:{shadow:"never"}},[a("span",{staticClass:"title"},[e._v("填写店铺表单: ")]),e._v(" "),a("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{"label-width":"100px",label:"店铺名称:",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"100px",label:"店铺图片:",prop:"img"}},[a("el-input",{attrs:{placeholder:"请填写图片URL，如您需要上传本地图片，请点击下方按钮上传"},model:{value:e.form.img,callback:function(t){e.$set(e.form,"img",t)},expression:"form.img"}}),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{action:e.url,"on-change":e.handleChange,"file-list":e.fileList,"on-success":e.handleImgUploadSuccess,"on-error":e.handleImgUploadFail,"before-upload":e.beforeImgUpload,"on-remove":e.removeImg,limit:1,headers:e.token,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传本地图片")])],1)],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"100px",label:"店铺桌位:"}},[a("el-input-number",{attrs:{min:0,label:"选择数量"},on:{change:e.handleChange},model:{value:e.tableNum,callback:function(t){e.tableNum=t},expression:"tableNum"}}),e._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.tableNum>0,expression:"tableNum > 0"}],staticStyle:{width:"100%"},attrs:{data:e.form.tables,stripe:""}},[a("el-table-column",{attrs:{prop:"date",label:"桌号",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:""},model:{value:t.row.table,callback:function(a){e.$set(t.row,"table",a)},expression:"scope.row.table"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"可容纳人数",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.row.capacity,callback:function(a){e.$set(t.row,"capacity",a)},expression:"scope.row.capacity"}})]}}])})],1)],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"100px",label:"店铺地址:",prop:"price"}},[a("el-input",{attrs:{placeholder:"请填写店铺地址"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",e._n(t))},expression:"form.address"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"100px",label:"店铺营业时间:",prop:"description"}},[a("el-input",{attrs:{placeholder:"请填写店铺营业时间"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",e._n(t))},expression:"form.time"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"100px",label:"店铺联系电话:",prop:"main"}},[a("el-input",{model:{value:e.form.contactPhone,callback:function(t){e.$set(e.form,"contactPhone",t)},expression:"form.contactPhone"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"100px",label:"开启外卖配送: "}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-text":"开启","inactive-text":"不开启"},model:{value:e.form.supportTakeout,callback:function(t){e.$set(e.form,"supportTakeout",t)},expression:"form.supportTakeout"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-left":"20px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.finishCommit("form")}}},[e._v("立即创建")]),e._v(" "),a("el-button",[e._v("取消")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(i,m,!1,function(e){a("YBKw")},null,null);t.a=c.exports},YBKw:function(e,t){},oqbK:function(e,t){},uoNb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={name:"addProduct",components:{StoreDetail:a("H4zi").a}},o={render:function(){var e=this.$createElement;return(this._self._c||e)("store-detail",{attrs:{"is-edit":!1}})},staticRenderFns:[]};var r=a("VU/8")(l,o,!1,function(e){a("oqbK")},null,null);t.default=r.exports}});
//# sourceMappingURL=4.b8529106254067bf9d66.js.map